<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TripBuddy Prototype</title>

  <!-- React + Babel + Tailwind via CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    .hero-bg {
      background-image: url('https://images.unsplash.com/photo-1469474968028-56623f02e42e?auto=format&fit=crop&w=2074&q=80');
      background-size: cover;
      background-position: center;
    }
    .glassmorphism {
      backdrop-filter: blur(12px);
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.08);
    }
    .card-hover { transition: transform .25s ease, box-shadow .25s ease; }
    .card-hover:hover { transform: translateY(-6px); box-shadow: 0 18px 40px rgba(0,0,0,0.4); }
  </style>
</head>
<body class="bg-black text-white">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    /************ Sample data with coordinates (lat, lon) ************/
    const userDefaultLocation = { name: "Sonipat, Haryana", lat: 28.9934, lon: 77.0182 }; // used for distance calc

 const destinations = [
  { id: 1, name: "Delhi", image: "delhi.jpg?auto=format&fit=crop&w=800&q=80", temp: "35°C", description: "The capital city with historic sites and modern vibes", activities: ["Sightseeing","Food Tours"], bestTime: "Oct - Mar", rating: 4.5, price: "$120", lat: 28.6139, lon: 77.2090 },
  { id: 2, name: "Goa", image: "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=800&q=80", temp: "30°C", description: "Beaches, nightlife, and Portuguese heritage", activities: ["Beach Parties","Water Sports"], bestTime: "Nov - Feb", rating: 4.7, price: "$150", lat: 15.2993, lon: 74.1240 },
  { id: 3, name: "Jaipur", image: "jaipur.jpg?auto=format&fit=crop&w=800&q=80", temp: "33°C", description: "The Pink City with palaces and forts", activities: ["Palace Tours","Shopping"], bestTime: "Oct - Mar", rating: 4.6, price: "$100", lat: 26.9124, lon: 75.7873 },
  { id: 4, name: "Manali", image: "manali.jpg?auto=format&fit=crop&w=800&q=80", temp: "12°C", description: "Hill station in the Himalayas with adventure sports", activities: ["Skiing","Trekking"], bestTime: "Mar - Jun", rating: 4.8, price: "$180", lat: 32.2432, lon: 77.1892 },
  { id: 5, name: "Mumbai", image: "mumbai.jpg?auto=format&fit=crop&w=800&q=80", temp: "33°C", description: "The financial hub with bustling city life", activities: ["City Tours","Food Walks"], bestTime: "Nov - Feb", rating: 4.4, price: "$140", lat: 19.0760, lon: 72.8777 },
  { id: 6, name: "Kolkata", image: "kolkata.jpg?auto=format&fit=crop&w=800&q=80", temp: "29°C", description: "Cultural city with colonial architecture and riverside charm", activities: ["Heritage Walks","Food Tours"], bestTime: "Oct - Mar", rating: 4.3, price: "$110", lat: 22.5726, lon: 88.3639 },
  { id: 7, name: "Udaipur", image: "udiapur.jpg?auto=format&fit=crop&w=800&q=80", temp: "32°C", description: "City of lakes with royal palaces", activities: ["Lake Cruises","Palace Visits"], bestTime: "Sep - Mar", rating: 4.7, price: "$130", lat: 24.5854, lon: 73.7125 },
  { id: 8, name: "Rishikesh", image: "rishikesh.jpg?auto=format&fit=crop&w=800&q=80", temp: "20°C", description: "Spiritual town on the Ganges with adventure sports", activities: ["River Rafting","Yoga Retreats"], bestTime: "Feb - Apr", rating: 4.8, price: "$90", lat: 30.0869, lon: 78.2676 },
  { id: 9, name: "Shimla", image: "shimla.jpg?auto=format&fit=crop&w=800&q=80", temp: "10°C", description: "Hilly getaway with colonial charm", activities: ["Trekking","Sightseeing"], bestTime: "Mar - Jun", rating: 4.6, price: "$120", lat: 31.1048, lon: 77.1734 },
  { id: 10, name: "Mysore", image: "mysore.jpg?auto=format&fit=crop&w=800&q=80", temp: "28°C", description: "City with royal heritage and gardens", activities: ["Palace Visits","Cultural Tours"], bestTime: "Oct - Mar", rating: 4.5, price: "$95", lat: 12.2958, lon: 76.6394 }
];



    /************ Small car DB for recognition (km per liter) ************/
    const carDB = [
      { model: "Maruti Swift", mileage: 22 },
      { model: "Hyundai i20", mileage: 18 },
      { model: "Honda City", mileage: 17 },
      { model: "Toyota Innova", mileage: 12 },
      { model: "Mahindra Thar", mileage: 10 },
      { model: "Tata Nexon", mileage: 16 }
    ];

    /************ Helpers ************/
    function haversineDistanceKm(lat1, lon1, lat2, lon2) {
      const toRad = deg => deg * Math.PI / 180;
      const R = 6371; // km
      const dLat = toRad(lat2 - lat1);
      const dLon = toRad(lon2 - lon1);
      const a = Math.sin(dLat/2)**2 + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)**2;
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

    function saveToLocal(key, data) {
      localStorage.setItem(key, JSON.stringify(data));
    }
    function loadFromLocal(key, fallback) {
      const raw = localStorage.getItem(key);
      return raw ? JSON.parse(raw) : fallback;
    }

    /************ App ************/
    function TravelApp(){
      const [currentPage, setCurrentPage] = useState('home');
      const [weather, setWeather] = useState(null);
      const [aiRecommendations, setAiRecommendations] = useState([]);
      const [isLoadingAI, setIsLoadingAI] = useState(false);
      const [selectedDestination, setSelectedDestination] = useState(null);

      const [user, setUser] = useState(loadFromLocal('ta_user', null));
      const [bookings, setBookings] = useState(loadFromLocal('ta_bookings', []));

      // Initialize fake weather (could later be replaced with OpenWeather fetch)
      useEffect(() => {
        setTimeout(() => {
          setWeather({ temp: 22, condition: 'Sunny', location: userDefaultLocation.name });
        }, 700);
      }, []);

      // Mini AI recs based on weather: warm -> beaches; cold -> mountains
      useEffect(() => {
        if (!weather) return;
        setIsLoadingAI(true);
        setTimeout(() => {
          const t = weather.temp;
          // simple rule: if temp >= 20 suggest beachy places first
          const numeric = Number(t);
          const recs = destinations.slice().sort((a,b) => {
            if (numeric >= 20) {
              // prioritize places with higher temp
              return Number(b.temp.replace('°C','')) - Number(a.temp.replace('°C',''));
            } else {
              return Number(a.temp.replace('°C','')) - Number(b.temp.replace('°C',''));
            }
          }).slice(0,3);
          setAiRecommendations(recs);
          setIsLoadingAI(false);
        }, 1000);
      }, [weather]);

      // Auth helpers
      const onLogin = (username) => {
        setUser({ username });
        saveToLocal('ta_user', { username });
      };
      const onLogout = () => {
        setUser(null);
        localStorage.removeItem('ta_user');
      };

      const addBooking = (booking) => {
        const newList = [...bookings, booking];
        setBookings(newList);
        saveToLocal('ta_bookings', newList);
      };

      /************ Sub-components ************/
      const Navbar = () => (
  <nav className="fixed top-0 left-0 right-0 z-50 glassmorphism px-4 py-3">
    <div className="max-w-7xl mx-auto flex items-center justify-between">
      
      {/* Logo + Home click */}
      <div
        className="flex items-center gap-3 cursor-pointer"
        onClick={() => { setCurrentPage('home'); setSelectedDestination(null); }}
      >
        
        <img
          src="WhatsApp Image 2025-09-14 at 10.58.19_f4c0fbd2.jpg"
          alt="TripBuddy Logo"
          className="header-logo h-20 w-20 object-contain"
        />
        <div className="text-xl font-bold">TripBuddy</div>
      </div>

      {/* Navigation links */}
      <div className="hidden md:flex gap-6 items-center">
        <button
          onClick={() => { setCurrentPage('home'); setSelectedDestination(null); }}
          className="hover:text-blue-400"
        >
          Home
        </button>
        <button
          onClick={() => setCurrentPage('destinations')}
          className="hover:text-blue-400"
        >
          Destinations
        </button>
        <button
          onClick={() => setCurrentPage('bookings')}
          className="hover:text-blue-400"
        >
          My Bookings
        </button>
      </div>

      {/* User auth */}
      <div className="flex items-center gap-3">
        {user ? (
          <>
            <div className="text-sm hidden sm:block">
              Hi, <span className="font-semibold">{user.username}</span>
            </div>
            <button
              onClick={onLogout}
              className="bg-gradient-to-r from-blue-600 to-purple-600 px-40 py-10 rounded-full text-sm"
            >
              Logout
            </button>
          </>
        ) : (
          <AuthButton onLogin={onLogin} />
        )}
      </div>
    </div>
  </nav>
);


      const AuthButton = ({ onLogin }) => {
        const [open, setOpen] = useState(false);
        const [mode, setMode] = useState('login'); // login | register
        const [username, setUsername] = useState('');
        const [password, setPassword] = useState('');

        const handleRegister = () => {
          if (!username) return alert('Enter a username');
          const users = loadFromLocal('ta_users', []);
          // naive: just push
          users.push({ username, password });
          saveToLocal('ta_users', users);
          alert('Registered — you can log in now');
          setMode('login');
        };
        const handleLogin = () => {
          const users = loadFromLocal('ta_users', []);
          const found = users.find(u => u.username === username && u.password === password);
          if (found) {
            onLogin(username);
            setOpen(false);
            setUsername(''); setPassword('');
          } else {
            alert('Invalid credentials (or register first).');
          }
        };

        return (
          <>
            <button onClick={()=>setOpen(true)} className="bg-blue-600 px-4 py-2 rounded-full">Sign In</button>
            {open && (
              <div className="fixed inset-0 z-60 flex items-center justify-center">
                <div className="absolute inset-0 bg-black/60" onClick={() => setOpen(false)}></div>
                <div className="relative w-full max-w-md p-6 glassmorphism rounded-xl">
                  <div className="flex justify-between items-center mb-4">
                    <h3 className="text-xl font-bold">{mode === 'login' ? 'Login' : 'Register'}</h3>
                    <button onClick={()=>setOpen(false)} className="text-gray-300"><i className="fas fa-times"></i></button>
                  </div>
                  <div className="space-y-3">
                    <input value={username} onChange={e=>setUsername(e.target.value)} placeholder="Username" className="w-full p-3 rounded bg-black/40"/>
                    <input type="password" value={password} onChange={e=>setPassword(e.target.value)} placeholder="Password" className="w-full p-3 rounded bg-black/40"/>
                    {mode === 'register' ? (
                      <button onClick={handleRegister} className="w-full bg-green-600 py-2 rounded">Register</button>
                    ) : (
                      <button onClick={handleLogin} className="w-full bg-blue-600 py-2 rounded">Login</button>
                    )}
                    <div className="text-sm text-gray-300 text-center">
                      {mode === 'login' ? (
                        <>No account? <button className="text-blue-300" onClick={()=>setMode('register')}>Register</button></>
                      ) : (
                        <>Have an account? <button className="text-blue-300" onClick={()=>setMode('login')}>Login</button></>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            )}
          </>
        );
      };

      const Hero = () => (
        <section className="hero-bg min-h-screen flex items-center justify-center relative">
          <div className="absolute inset-0 bg-black/60"></div>
          <div className="relative z-10 text-center px-4 max-w-4xl">
            <h1 className="text-4xl md:text-6xl font-bold mb-4">Discover Your Next Adventure</h1>
            <p className="text-gray-300 mb-6"></p>
            <div className="glassmorphism p-4 rounded-xl">
              <div className="grid md:grid-cols-4 gap-3">
                <input id="where" placeholder="Where to?" className="p-3 rounded bg-black/30" />
                <input type="date" className="p-3 rounded bg-black/30" />
                <select className="p-3 rounded bg-black/30">
                  <option>1 Guest</option>
                  <option>2 Guests</option>
                  <option>3 Guests</option>
                </select>
                <button className="bg-gradient-to-r from-blue-600 to-purple-600 px-4 py-2 rounded" onClick={()=>setCurrentPage('destinations')}>Search</button>
            

            </div>
            
            <div>
                 <button className="bg-gradient-to-r from-blue-600 to-purple-600 px-4 py-2 rounded" onClick={()=>setCurrentPage('destinations')}>Recommendations</button>
            </div>
            </div>
          </div>
          
        </section>
        
      );
      

      const HomePage = () => (
        <div>
          <Hero />
          <section className="py-12 max-w-7xl mx-auto px-4">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-2xl font-bold">AI Recommendations</h2>
              <div className="text-gray-400">Current: {weather ? `${weather.temp}°C · ${weather.condition}` : 'Loading...'}</div>
            </div>

            {isLoadingAI ? (
              <div className="p-8 text-center">
                <div className="inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 mb-4"><i className="fas fa-brain text-white text-2xl"></i></div>
                <div>AI is generating suggestions...</div>
              </div>
            ) : (
              <div className="grid md:grid-cols-3 gap-6">
                {aiRecommendations.map(d => (
                  <div key={d.id} className="card-hover bg-gray-800 rounded-lg overflow-hidden cursor-pointer" onClick={()=>{ setSelectedDestination(d); setCurrentPage('destination'); }}>
                    <img src={d.image} className="w-full h-44 object-cover"/>
                    <div className="p-4">
                      <div className="flex justify-between items-center mb-2">
                        <h3 className="text-lg font-bold">{d.name}</h3>
                        <span className="text-sm text-green-400">{d.price}</span>
                      </div>
                      <p className="text-sm text-gray-300">{d.description}</p>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </section>

          <section className="py-12 bg-gray-900">
            <div className="max-w-7xl mx-auto px-4">
              <h2 className="text-2xl font-bold mb-6">Trending Destinations</h2>
              <div className="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
                {destinations.map(d => (
                  <div key={d.id} className="card-hover bg-gray-800 rounded-lg overflow-hidden cursor-pointer" onClick={()=>{setSelectedDestination(d); setCurrentPage('destination');}}>
                    <img src={d.image} className="w-full h-36 object-cover"/>
                    <div className="p-3">
                      <h4 className="font-semibold">{d.name}</h4>
                      <div className="text-sm text-gray-400">{d.bestTime} · {d.temp}</div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </section>
        </div>
      );

      const DestinationsPage = () => (
        <div className="pt-20 min-h-screen bg-gray-900">
          <div className="max-w-7xl mx-auto p-6">
            <h1 className="text-3xl font-bold mb-6">All Destinations</h1>
            <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {destinations.map(d => (
                <div key={d.id} className="bg-gray-800 rounded-lg overflow-hidden card-hover cursor-pointer" onClick={()=>{setSelectedDestination(d); setCurrentPage('destination');}}>
                  <img src={d.image} className="w-full h-48 object-cover" />
                  <div className="p-4">
                    <h3 className="text-lg font-bold">{d.name}</h3>
                    <p className="text-sm text-gray-300">{d.description}</p>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );

      /**************** Destination page with booking & cost calc ****************/
      function DestinationDetail(){
        const d = selectedDestination;
        const [travellers, setTravellers] = useState(1);
        const [carModel, setCarModel] = useState('');
        const [recognized, setRecognized] = useState(false);
        const [mileage, setMileage] = useState(''); // km per liter
        const [fuelPrice, setFuelPrice] = useState(100); // default currency per liter
        const [roundTrip, setRoundTrip] = useState(true);
        const [calcResult, setCalcResult] = useState(null);

        useEffect(() => {
          // reset on new destination open
          setTravellers(1); setCarModel(''); setRecognized(false); setMileage(''); setCalcResult(null);
        }, [d?.id]);

        const recognizeModel = () => {
          if (!carModel) return alert('Type car model name to recognize (e.g., "Maruti Swift")');
          const found = carDB.find(c => c.model.toLowerCase() === carModel.trim().toLowerCase());
          if (found) {
            setRecognized(true);
            setMileage(found.mileage);
            alert(`Recognized "${found.model}" — mileage ${found.mileage} km/l`);
          } else {
            setRecognized(false);
            setMileage('');
            alert('Model not recognized. Please enter mileage manually (km/l).');
          }
        };

        const calculateCost = () => {
          if (!d) return;
          const m = Number(mileage);
          const t = Number(travellers);
          const fp = Number(fuelPrice);
          if (!m || m <= 0) return alert('Enter a valid mileage (km per liter).');
          if (!t || t <= 0) return alert('Enter number of travellers (>=1).');
          if (!fp || fp <= 0) return alert('Enter fuel price per liter.');

          const dist = haversineDistanceKm(userDefaultLocation.lat, userDefaultLocation.lon, d.lat, d.lon);
          const totalDist = roundTrip ? dist * 2 : dist;
          const fuelNeeded = totalDist / m; // liters
          const totalCost = fuelNeeded * fp;
          const costPerPerson = totalCost / t;

          setCalcResult({
            dist: dist.toFixed(1),
            totalDist: totalDist.toFixed(1),
            fuelNeeded: fuelNeeded.toFixed(2),
            totalCost: totalCost.toFixed(2),
            costPerPerson: costPerPerson.toFixed(2)
          });
        };

        const saveBooking = () => {
          if (!calcResult) return alert('Calculate cost before saving booking.');
          const booking = {
            id: Date.now(),
            destinationId: d.id,
            destinationName: d.name,
            travellers,
            carModel: carModel || 'Unknown',
            mileage,
            roundTrip,
            fuelPrice,
            calcResult,
            date: new Date().toLocaleString()
          };
          addBooking(booking);
          alert('Booking saved to My Bookings');
        };

        return (
          <div className="pt-20 min-h-screen bg-gray-900 pb-12">
            <div className="relative h-64">
              <img src={d.image} className="w-full h-full object-cover"/>
              <div className="absolute inset-0 bg-black/50 flex items-end">
                <div className="max-w-7xl mx-auto p-6 w-full">
                  <h1 className="text-4xl font-bold">{d.name}</h1>
                  <p className="text-gray-300">{d.description}</p>
                </div>
              </div>
            </div>

            <div className="max-w-7xl mx-auto p-6 grid lg:grid-cols-3 gap-6">
              <div className="lg:col-span-2 space-y-6">
                <div className="bg-gray-800 p-6 rounded-lg">
                  <h2 className="text-2xl font-bold mb-3">Plan Your Trip</h2>
                  <div className="grid sm:grid-cols-2 gap-3">
                    <div>
                      <label className="text-sm text-gray-400">Number of Travellers</label>
                      <input type="number" min="1" value={travellers} onChange={e=>setTravellers(e.target.value)} className="w-full p-3 rounded bg-black/30 mt-1" />
                    </div>

                    <div>
                      <label className="text-sm text-gray-400">Round Trip</label>
                      <div className="mt-1 flex items-center gap-3">
                        <input id="rt" type="checkbox" checked={roundTrip} onChange={e=>setRoundTrip(e.target.checked)} />
                        <label htmlFor="rt" className="text-sm">Round trip (return)</label>
                      </div>
                    </div>

                    <div>
                      <label className="text-sm text-gray-400">Car Model</label>
                      <input placeholder="Type car model (e.g. Maruti Swift)" value={carModel} onChange={e=>setCarModel(e.target.value)} className="w-full p-3 rounded bg-black/30 mt-1"/>
                      <div className="flex gap-2 mt-2">
                        <button onClick={recognizeModel} className="bg-indigo-600 px-3 py-2 rounded">Recognize</button>
                        <button onClick={()=>{ setCarModel(''); setMileage(''); setRecognized(false); }} className="bg-gray-700 px-3 py-2 rounded">Reset</button>
                      </div>
                    </div>

                    <div>
                      <label className="text-sm text-gray-400">Mileage (km / liter)</label>
                      <input placeholder="e.g. 15" value={mileage} onChange={e=>setMileage(e.target.value)} className="w-full p-3 rounded bg-black/30 mt-1" />
                      <div className="text-xs text-gray-400 mt-1">{recognized ? 'Recognized from DB' : 'Enter manually if model not recognized'}</div>
                    </div>

                    <div>
                      <label className="text-sm text-gray-400">Fuel Price (per liter)</label>
                      <input value={fuelPrice} onChange={e=>setFuelPrice(e.target.value)} className="w-full p-3 rounded bg-black/30 mt-1" />
                      <div className="text-xs text-gray-400 mt-1">Enter local fuel price (default value)</div>
                    </div>

                    <div className="sm:col-span-2">
                      <button onClick={calculateCost} className="bg-gradient-to-r from-green-600 to-blue-600 px-4 py-3 rounded mt-3">Calculate Travel Cost</button>
                    </div>
                  </div>
                </div>

                <div className="bg-gray-800 p-6 rounded-lg">
                  <h2 className="text-2xl font-bold mb-3">Popular Activities</h2>
                  <div className="flex gap-2 flex-wrap">
                    {d.activities.map((a,i) => <span key={i} className="bg-black/30 px-3 py-1 rounded">{a}</span>)}
                  </div>
                </div>
              </div>

              <div className="space-y-6">
                <div className="bg-gray-800 p-4 rounded-lg">
                  <h3 className="font-semibold mb-2">Trip Summary</h3>
                  <div className="text-sm text-gray-300 mb-2">From: <strong>{userDefaultLocation.name}</strong></div>
                  <div className="text-sm text-gray-300 mb-2">To: <strong>{d.name}</strong></div>
                  <div className="text-sm text-gray-300">Distance (one-way): <strong>{haversineDistanceKm(userDefaultLocation.lat, userDefaultLocation.lon, d.lat, d.lon).toFixed(1)} km</strong></div>
                </div>

                <div className="bg-gray-800 p-4 rounded-lg">
                  <h3 className="font-semibold mb-2">Cost Result</h3>
                  {calcResult ? (
                    <>
                      <div className="text-sm text-gray-300 mb-1">Total distance: <strong>{calcResult.totalDist} km</strong></div>
                      <div className="text-sm text-gray-300 mb-1">Fuel needed: <strong>{calcResult.fuelNeeded} L</strong></div>
                      <div className="text-sm text-gray-300 mb-1">Estimated cost: <strong>{calcResult.totalCost}</strong></div>
                      <div className="text-sm text-gray-300 mb-3">Per person: <strong>{calcResult.costPerPerson}</strong></div>
                      <button onClick={saveBooking} className="w-full bg-blue-600 py-2 rounded">Save Booking</button>
                    </>
                  ) : (
                    <div className="text-gray-400">Calculate cost to see results</div>
                  )}
                </div>
              </div>
            </div>
          </div>
        );
      }

      const BookingsPage = () => (
        <div className="pt-20 min-h-screen bg-gray-900">
          <div className="max-w-5xl mx-auto p-6">
            <h2 className="text-2xl font-bold mb-4">My Bookings</h2>
            {bookings.length === 0 ? (
              <div className="text-gray-400">No bookings yet — plan a trip and save it!</div>
            ) : (
              <div className="space-y-4">
                {bookings.map(b => (
                  <div key={b.id} className="bg-gray-800 p-4 rounded-lg">
                    <div className="flex justify-between items-start">
                      <div>
                        <div className="font-semibold">{b.destinationName}</div>
                        <div className="text-sm text-gray-400">{b.date}</div>
                        <div className="text-sm text-gray-300 mt-2">Travellers: {b.travellers} · Car: {b.carModel} · Mileage: {b.mileage} km/l</div>
                      </div>
                      <div className="text-right">
                        <div className="text-sm text-gray-300">Total Cost</div>
                        <div className="font-bold">{b.calcResult.totalCost}</div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>
      );

      /************ Chatbot (simple rule-based) ************/
      function Chatbot() {
        const [open, setOpen] = useState(false);
        const [messages, setMessages] = useState([
          { from: 'bot', text: `Hi! I'm your Trip Assistant. Ask me about destinations, cost calc or next steps.`}
        ]);
        const [input, setInput] = useState('');

        const send = () => {
          if (!input.trim()) return;
          const userMsg = { from: 'user', text: input };
          setMessages(prev => [...prev, userMsg]);
          setInput('');

          // simple rule-based responses
          setTimeout(() => {
            const q = input.toLowerCase();
            let reply = "Sorry, I don't understand — try asking about recommended places, cost, or steps.";
            if (q.includes('recommend') || q.includes('where') || q.includes('suggest')) {
              reply = "Try Maldives for beaches, Santorini for sunsets, Swiss Alps for mountains. Click on any card to plan.";
            } else if (q.includes('cost') || q.includes('fuel') || q.includes('mileage')) {
              reply = "To calculate cost: select destination → enter travellers → enter car model or mileage → set fuel price → Calculate.";
            } else if (q.includes('book') || q.includes('hotel')) {
              reply = "After calculating cost, click 'Save Booking' then go to My Bookings. Hotels can be added later via API.";
            } else if (q.includes('hello') || q.includes('hi')) {
              reply = "Hello! How can I help your trip today?";
            } else if (q.includes('help')) {
              reply = "I can suggest places, explain how cost is calculated, and help with booking flow.";
            }
            setMessages(prev => [...prev, { from: 'bot', text: reply }]);
          }, 600);
        };

        return (
          <>
           
            {open && (
              <div className="fixed inset-0 z-50 flex items-end justify-end">
                <div className="absolute inset-0 bg-black/50" onClick={()=>setOpen(false)}></div>
                <div className="relative w-full max-w-md m-6 bg-gray-900 rounded-xl p-4">
                  <div className="flex justify-between items-center mb-3">
                    <h4 className="font-semibold">Trip Assistant</h4>
                    <button className="text-gray-300" onClick={()=>setOpen(false)}><i className="fas fa-times"></i></button>
                  </div>
                  <div className="h-64 overflow-y-auto p-2 space-y-2 bg-black/20 rounded mb-3">
                    {messages.map((m, i) => (
                      <div key={i} className={m.from === 'bot' ? "text-sm bg-gray-800 p-2 rounded" : "text-sm bg-blue-700 p-2 rounded self-end"}>
                        <div className={m.from === 'bot' ? "text-gray-300" : "text-white"}>{m.text}</div>
                      </div>
                    ))}
                  </div>

                  <div className="flex gap-2">
                    <input value={input} onChange={e=>setInput(e.target.value)} placeholder="Ask me anything..." className="flex-1 p-2 rounded bg-black/30"/>
                    <button onClick={send} className="bg-blue-600 px-3 py-2 rounded">Send</button>
                  </div>
                </div>
              </div>
            )}
          </>
        );
      }

      /************ Render main UI depending on page ************/
      return (
        <div className="min-h-screen">
          <Navbar />
          <main className="pt-20">
            {currentPage === 'home' && <HomePage />}
            {currentPage === 'destinations' && <DestinationsPage />}
            {currentPage === 'destination' && selectedDestination && <DestinationDetail />}
            {currentPage === 'bookings' && <BookingsPage />}
          </main>

          {/* Weather floating widget */}
          {weather && (
            <div className="fixed bottom-6 right-6 bg-black/80 p-3 rounded-xl border border-white/10 z-40">
              <div className="flex items-center gap-3">
                <div className="bg-gradient-to-br from-blue-500 to-purple-600 p-2 rounded">
                  <i className="fas fa-sun text-white"></i>
                </div>
                <div>
                  <div className="text-xs text-gray-300">Current Weather</div>
                  <div className="text-sm">{weather.temp}°C · {weather.condition}</div>
                </div>
              </div>
            </div>
          )}

          <Chatbot />
        </div>
      );
    }

    /******** render *********/
    ReactDOM.createRoot(document.getElementById('root')).render(<TravelApp />);
  </script>
  <script type="text/javascript">
  (function(d, t) {
      var v = d.createElement(t), s = d.getElementsByTagName(t)[0];
      v.onload = function() {
        window.voiceflow.chat.load({
          verify: { projectID: '68c723f1563ae0917ad6bd3f' },
          url: 'https://general-runtime.voiceflow.com',
          versionID: 'production',
          voice: {
            url: "https://runtime-api.voiceflow.com"
          }
        });
      }
      v.src = "https://cdn.voiceflow.com/widget-next/bundle.mjs"; v.type = "text/javascript"; s.parentNode.insertBefore(v, s);
  })(document, 'script');
</script>
</body>
</html>
